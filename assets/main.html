<header class="h-14 flex-row align-center justify-between px-3">
    <div class="flex-row align-center">
        <img class="logo mx-2" :src="logoList.align" @click="menuShow=true" x-show="!menuShow">
<!--        todo select二级菜单-->
        <select class="mx-2 my-0" aria-label x-model="chatForm.model">
            <template x-for="m in await (await fetch('/model',{method:'POST'})).json()">
                <optgroup :label="m.Type" label="">
                    <template x-for="n in m?.List?.split(',')">
                        <option :value="n" x-text="n"></option>
                    </template>
                </optgroup>
            </template>
        </select>
    </div>
    <div>
        <img class="logo" :src="logoList.more">
        <svg width="30" height="30">
            <circle cx="15" cy="15" r="12" fill="#007bff" />
            <text x="15" y="18" font-size="10" text-anchor="middle" fill="#fff" x-text="1"></text>
        </svg>
    </div>
</header>

<article class="flex-col flex-10">
    <template x-for="m in chatForm.messages" >
        <section class="flex-row px-3 py-4"  :class="{ 'justify-end': m.role === 'user' }">
            <div class="flex-col">
                <span class="py-1"><b>User</b></span>
                <div class="py-1" x-text="m.content"></div>
            </div>
        </section>
        <section class="flex-row px-3 py-4" >
            <svg width="30" height="30">
                <circle cx="15" cy="15" r="15" fill="#007bff" />
                <text x="15" y="18" font-size="10" text-anchor="middle" fill="#fff" x-text="1"></text>
            </svg>
            <div class="flex-col px-2">
                <span class="py-1"><b>gpt-4o</b></span>
                <div class="py-1" x-text="m.content"></div>
            </div>
        </section>
    </template>
</article>

<footer class="flex-1 px-3 flex-col justify-center">
    <form class="flex-row align-center p-2" @submit.prevent="">
        <img class="logo" :src="logoList.add">
        <img  class="logo" :src="logoList.slider" @click="chatSettingShow=true">
        <textarea class="m-0 mx-3 resize-none" rows="1"></textarea>
        <img class="logo" :src="logoList.mic">
        <button @click="postCompletion">sse</button>
    </form>
</footer>

<dialog :open="chatSettingShow">
    <article>
        <header class="p-3">
            <a rel="prev" @click.prevent="chatSettingShow=false"></a>
            <strong class="m-3">高级对话设置</strong>
        </header>
        <form>
            <label>
                系统提示词 (System Prompt)
                <textarea rows="3" placeholder="输入系统提示词 (Prompt)"></textarea>
            </label>
            <label>
                以流式返回对话响应
                <input name="terms" type="checkbox" role="switch" />
            </label>
            <label>
                种子 (Seed)
                <button type="button">默认</button>
            </label>
            <label>
                停止序列 (Stop Sequence)
                <input type="range" min="0" max="100" value="50">
            </label>
            <label>
                温度 (Temperature)
                <input type="range" min="0" max="1" step="0.1" value="0.7">
            </label>
            <label>
                Mirostat
                <input type="range" min="0" max="2" step="1" value="0">
            </label>
            <label>
                Mirostat Eta
                <input type="range" min="0.01" max="0.99" step="0.01" value="0.1">
            </label>
            <label>
                Mirostat Tau
                <input type="range" min="0" max="10" step="0.1" value="5">
            </label>
            <label>
                Top K
                <input type="range" min="0" max="100" value="40">
            </label>
            <label>
                Top P
                <input type="range" min="0" max="1" step="0.01" value="0.9">
            </label>
            <label>
                Min P
                <input type="range" min="0" max="1" step="0.01" value="0.05">
            </label>
            <label>
                频率惩罚
                <input type="range" min="0" max="2" step="0.1" value="0.5">
            </label>
            <label>
                重复最后 N 次
                <input type="range" min="0" max="2" step="0.1" value="0.5">
            </label>
            <label>
                Tfs Z
                <input type="range" min="0" max="2" step="0.1" value="0.5">
            </label>
            <label>
                上下文长度
                <input type="range" min="0" max="2" step="0.1" value="0.5">
            </label>
            <label>
                批大小 (num_batch)
                <input type="range" min="0" max="2" step="0.1" value="0.5">
            </label>
            <label>
                最多 Token (num_predict)
                <input type="range" min="0" max="2" step="0.1" value="0.5">
            </label>
        </form>
    </article>
</dialog>

